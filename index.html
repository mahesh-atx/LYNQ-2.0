<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home â€” LYNQ AI</title>

    <script
      src="https://kit.fontawesome.com/ae8ff12b97.js"
      crossorigin="anonymous"
    ></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@200;300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css"
    />

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <!-- Added PDF.js library for text extraction -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>
      // Required by PDF.js
      pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js`;
    </script>

    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="./home/home.css" />

    <style>
      .confirm-modal-overlay {
        position: fixed;
        inset: 0;
        background-color: rgba(0, 0, 0, 0.6);
        display: none; /* Hidden by default */
        align-items: center;
        justify-content: center;
        z-index: 1000;
      }
      .confirm-modal-overlay.active {
        display: flex;
      }
      .confirm-modal {
        background-color: var(--bg-secondary);
        border-radius: 12px;
        padding: 24px;
        width: 90%;
        max-width: 400px;
        border: 1px solid var(--border-primary);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        animation: modalFadeIn 0.2s ease-out;
      }
      .confirm-modal h3 {
        margin-top: 0;
        margin-bottom: 10px;
        color: var(--text-primary);
      }
      .confirm-modal p {
        margin-bottom: 20px;
        color: var(--text-secondary);
        font-size: 0.9rem;
        line-height: 1.5;
        /* Allow word breaking for long chat titles */
        word-break: break-word;
      }
      .confirm-modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }
      .confirm-btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      .confirm-btn-cancel {
        background-color: var(--bg-tertiary);
        color: var(--text-secondary);
      }
      .confirm-btn-cancel:hover {
        background-color: var(--border-primary);
      }
      .confirm-btn-delete {
        background-color: #d9534f;
        color: white;
      }
      .confirm-btn-delete:hover {
        background-color: #c9302c;
      }

      @keyframes modalFadeIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
    </style>
  </head>
  <!-- MODIFIED: Added dark-mode class to set it as default theme -->
  <body class="dark-mode">
    <div id="app-container">
      <!-- MODIFIED: Added collapsed class to hide the sidebar by default on desktop -->
      <aside id="sidebar" class="collapsed">
        <div style="flex-shrink: 0">
          <div class="sidebar-header">
            <span style="display: flex; align-items: center; gap: 10px"
              ><i class="fa-solid fa-bolt"></i> LYNQ AI</span
            >
            <button class="action-btn mobile-only" onclick="toggleSidebar()">
              <i class="fa-solid fa-xmark"></i>
            </button>
          </div>
        </div>

        <nav class="nav-menu">
          <div class="nav-label">Menu</div>
          <a
            href="#"
            class="nav-item"
            onclick="resetChat();"
            id="nav-new-chat"
            ><i class="fa-solid fa-plus"></i> New Chat</a
          >
          <a
            href="index.html"
            class="nav-item active"
            id="nav-home"
            ><i class="fa-solid fa-house"></i> Home</a
          >
          
          <a
            href="projects.html"
            class="nav-item"
            id="nav-projects"
            ><i class="fa-solid fa-layer-group"></i> Projects</a
          >

          <div
            class="nav-label"
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              padding-right: 5px;
              position: relative;
            "
          >
            <span id="recent-chats-label">Recent Chats</span>
            <input
              type="text"
              id="chat-search-input"
              placeholder="Search chats..."
              style="
                display: none;
                width: 100%;
                background: var(--bg-primary);
                border: 1px solid var(--border-primary);
                border-radius: 6px;
                padding: 4px 8px;
                color: var(--text-primary);
              "
              onkeyup="filterRecentChats()"
              onblur="toggleChatSearch(false)"
            />
            <i
              class="fa-solid fa-magnifying-glass search-trigger"
              id="chat-search-trigger"
              onclick="toggleChatSearch(true)"
            ></i>
          </div>
          <div id="recent-chats-container"></div>
        </nav>

        <div class="sidebar-footer">
          <a href="settings.html" class="nav-item" id="nav-settings"
            ><i class="fa-solid fa-gear"></i> Settings</a
          >
          <!-- MODIFIED: Removed icons from Log In and Sign Up links -->
          <a
            href="login.html?action=login"
            class="nav-item"
            id="nav-login-link"
            style="margin-top: 5px;"
          >
            Log In
          </a>
          <a
            href="login.html?action=signup"
            class="nav-item"
            id="nav-signup-link"
          >
            Sign Up
          </a>
          <!-- UPDATED: Profile Link - Initially hidden, visible only when logged in -->
          <a
            href="profile.html"
            class="nav-item"
            id="nav-profile-wrapper"
            style="margin-top: 5px; display: none;"
          >
            <div
              class="avatar user"
            >
              MD
            </div>
            Mahesh Dongare
          </a>
        </div>
      </aside>

      <main id="main-content">
        <div class="top-bar">
          <!-- The icon button that opens the sidebar remains visible -->
          <button class="action-btn" onclick="toggleSidebar()">
            <i class="fa-solid fa-bars"></i>
          </button>
          <!-- NEW: Logo and Title added here -->
          <div class="top-logo-title">
            <i class="fa-solid fa-bolt"></i> LYNQ AI
          </div>
          <div style="flex: 1"></div>
          <div class="top-actions">
            <button class="upgrade-btn" onclick="togglePricing()">
              <i class="fa-regular fa-gem"></i> <span>Upgrade to Pro</span>
            </button>
            <!-- MODIFIED: Removed icons from Log In and Sign Up buttons -->
            <button class="top-profile-btn" onclick="location.href='login.html?action=login'" id="login-btn" style="margin-right: 8px;">
              <span>Log In</span>
            </button>
            <button class="top-profile-btn" onclick="location.href='login.html?action=signup'" id="signup-btn" style="margin-right: 8px; background: var(--bg-accent); color: var(--text-accent);">
              <span>Sign Up</span>
            </button>
            <!-- UPDATED: Profile Button - Initially hidden, visible only when logged in -->
            <button class="top-profile-btn" onclick="location.href='profile.html'" id="top-profile-btn-user" style="display: none;">
              <div class="avatar user">MD</div>
              <span>Mahesh</span>
            </button>
          </div>
        </div>

        <div id="home-view" class="view-section active">
          
          <div id="chat-wrapper">
            <!-- PDF Attachment bar removed from here -->

            <div id="chat-container">
              <div class="welcome-screen" id="welcome-screen">
                <div class="welcome-text">
                  <h1>Hello, Mahesh</h1>
                  <p style="color: var(--text-secondary)">
                    How can I help you create today?
                  </p>
                </div>
                <div class="suggestion-grid">
                  <div
                    class="suggestion-card"
                    onclick="sendSuggestion('Review my portfolio code for SEO best practices.')"
                  >
                    <i class="fa-solid fa-code fa-lg"></i>
                    <p>Review my portfolio code</p>
                  </div>
                  <div
                    class="suggestion-card"
                    onclick="sendSuggestion('Generate a modern color palette for a SaaS dashboard.')"
                  >
                    <i class="fa-solid fa-palette fa-lg"></i>
                    <p>Generate UI color palette</p>
                  </div>
                  <div
                    class="suggestion-card"
                    onclick="sendSuggestion('Write a Python script to automate file organization.')"
                  >
                    <i class="fa-brands fa-python fa-lg"></i>
                    <p>Python automation script</p>
                  </div>
                  <div
                    class="suggestion-card"
                    onclick="sendSuggestion('Explain the key differences between SQL and NoSQL.')"
                  >
                    <i class="fa-solid fa-database fa-lg"></i>
                    <p>Explain SQL vs NoSQL</p>
                  </div>
                </div>
              </div>
              <div id="messages-wrapper"></div>
            </div>

            <div class="input-area-wrapper">
              <!-- Hidden file input for PDF uploads -->
              <input
                type="file"
                id="file-upload"
                accept="application/pdf"
                style="display: none"
              />
              <div class="input-container">
                <!-- NEW: Container for file pills above the textarea -->
                <div id="attachment-preview-container"></div>
                
                <textarea
                  id="chat-input"
                  rows="1"
                  placeholder="Ask LYNQ anything..."
                ></textarea>
                <div class="input-toolbar">
                  <div class="toolbar-left">
                    <!-- This button now triggers file upload -->
                    <button class="tool-btn-round" id="attach-file-btn" title="Attach PDF File">
                      <i class="fa-solid fa-plus"></i>
                    </button>
                    <!-- Tools Dropdown -->
                    <div class="tool-dropdown-wrapper">
                      <button class="tool-btn-round" id="tools-toggle-btn" title="Toggle Tools">
                        <i class="fa-solid fa-tools"></i> <!-- New Icon -->
                      </button>
                      <div class="tool-dropdown-menu" id="tools-dropdown">
                        <button class="tool-dropdown-item" id="canvas-toggle-btn">
                          <i class="fa-solid fa-file-invoice"></i>
                          <div>
                            <span>Canvas</span>
                            <span class="tool-desc">Open the code canvas</span>
                          </div>
                        </button>
                        <!-- PDF Chat is now a toggle, but we won't use it. Logic is automatic. -->
                        <button class="tool-dropdown-item" id="pdf-chat-btn" style="display: none;">
                          <i class="fa-solid fa-file-pdf"></i>
                          <div>
                            <span>PDF Chat</span>
                            <span class="tool-desc">Toggle chat with attached PDF</span>
                          </div>
                        </button>
                      </div>
                    </div>
                    <!-- End: Tools Dropdown -->
                    <div class="model-selector-wrapper">
                      <button
                        class="model-btn"
                        onclick="toggleModelDropdown()"
                        id="current-model-btn"
                      >
                        <i class="fa-solid fa-bolt" style="color: #ffd700"></i>
                        1.5 Pro <i class="fa-solid fa-chevron-down chevron"></i>
                      </button>
                      <div class="model-dropdown" id="model-dropdown">
                        <div
                          class="model-option selected"
                          onclick="selectModel(this, 'llama-3.1-8b-instant', 'fa-bolt', '#FFD700')"
                        >
                          <span
                            ><i
                              class="fa-solid fa-bolt"
                              style="color: #ffd700; margin-right: 8px"
                            ></i>
                            llama-3.1-8b</span
                          >
                          <span class="pro-badge">Pro</span>
                          <i class="fa-solid fa-check check-icon"></i>
                        </div>
                        <div
                          class="model-option"
                          onclick="selectModel(this, 'openai/gpt-oss-20b', 'fa-robot', '#10a37f')"
                        >
                          <span
                            ><i
                              class="fa-solid fa-robot"
                              style="color: #10a37f; margin-right: 8px"
                            ></i>
                            GPT-OSS-20B</span
                          >
                          <span class="pro-badge">Pro</span>
                          <i
                            class="fa-solid fa-check check-icon"
                            style="display: none"
                          ></i>
                        </div>
                        <div
                          class="model-option"
                          onclick="selectModel(this, 'meta-llama/llama-4-scout-17b-16e-instruct', 'fa-bolt-lightning', '#FF4500')"
                        >
                          <span
                            ><i
                              class="fa-solid fa-bolt-lightning"
                              style="color: #ff4500; margin-right: 8px"
                            ></i>
                            Llama-4-scout</span
                          >
                          <i
                            class="fa-solid fa-check check-icon"
                            style="display: none"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="toolbar-right">
                    <button class="tool-btn-round">
                      <i class="fa-solid fa-microphone-lines"></i>
                    </button>
                    <button
                      class="tool-btn-round send-btn"
                      id="send-btn"
                      onclick="handleSend()"
                    >
                      <i class="fa-solid fa-arrow-up"></i>
                    </button>
                    <button
                      class="tool-btn-round stop-btn"
                      id="stop-btn"
                      onclick="stopResponse()"
                      style="display: none"
                    >
                      <i class="fa-solid fa-square"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div
                style="
                  text-align: center;
                  margin-top: 10px;
                  font-size: 0.75rem;
                  color: var(--text-secondary);
                  opacity: 0.7;
                "
              >
                LYNQ AI can make mistakes. Check important info.
              </div>
            </div>
          </div>
          <div id="canvas-pane">
            <div class="canvas-header">
              <div class="canvas-tabs">
                <button class="canvas-tab active" id="canvas-tab-code">
                  <i class="fa-solid fa-code"></i>
                  <span>Code</span>
                </button>
                <button class="canvas-tab" id="canvas-tab-preview">
                  <i class="fa-solid fa-eye"></i>
                  <span>Preview</span>
                </button>
              </div>
              <div class="canvas-actions">
                <button class="tool-btn-round" id="canvas-download-btn" title="Download Code">
                  <i class="fa-solid fa-download"></i>
                </button>
                <button class="tool-btn-round" id="canvas-close-btn" title="Close Canvas">
                  <i class="fa-solid fa-xmark"></i>
                </button>
              </div>
            </div>
            <div id="canvas-content">
              <pre><code id="canvas-code-block" class="language-plaintext"></code></pre>
              <div id="canvas-placeholder">
                <i class="fa-solid fa-code"></i>
                <p>Code from the conversation will appear here when Canvas Mode is active.</p>
              </div>
            </div>

            <div id="canvas-preview-wrapper" style="display: none;">
              <div id="canvas-preview-placeholder">
                <i class="fa-solid fa-eye"></i>
                <p>Click the "Preview" tab to see rendered HTML/CSS.</p>
              </div>
              <iframe id="canvas-preview-iframe" title="Canvas Preview"></iframe>
            </div>
            </div>
          </div>
        </main>
    </div>

    <div id="toast">
      <i class="fa-solid fa-circle-check"></i> Link copied to clipboard!
    </div>

    <div class="modal-overlay" id="pricing-modal">
      <div class="pricing-modal">
        <button class="close-modal" onclick="togglePricing()">&times;</button>
        <div class="pricing-header">
          <h2>Upgrade Your Plan</h2>
          <p style="color: var(--text-secondary)">
            Unlock the full power of AI with Pro features.
          </p>
        </div>
        <div class="pricing-grid">
          <div class="price-card">
            <h3>Starter</h3>
            <div class="price">
              $0<span style="font-size: 1rem; font-weight: 400">/mo</span>
            </div>
            <ul class="features-list">
              <li><i class="fa-solid fa-check"></i> Gemini Flash Model</li>
              <li><i class="fa-solid fa-check"></i> Standard Speed</li>
              <li><i class="fa-solid fa-check"></i> 5 Projects Limit</li>
            </ul>
            <button class="plan-btn free">Current Plan</button>
          </div>
          <div class="price-card pro">
            <div class="popular-tag">MOST POPULAR</div>
            <h3>Pro Member</h3>
            <div class="price">
              $19<span style="font-size: 1rem; font-weight: 400">/mo</span>
            </div>
            <ul class="features-list">
              <li>
                <i class="fa-solid fa-check"></i> <b>Gemini 1.5 Pro & GPT-4o</b>
              </li>
              <li><i class="fa-solid fa-check"></i> Unlimited Fast Projects</li>
              <li><i class="fa-solid fa-check"></i> Priority Support</li>
              <li><i class="fa-solid fa-check"></i> Code Execution</li>
            </ul>
            <button class="plan-btn pro">Upgrade Now</button>
          </div>
          <div class="price-card">
            <h3>Team</h3>
            <div class="price">
              $49<span style="font-size: 1rem; font-weight: 400">/mo</span>
            </div>
            <ul class="features-list">
              <li><i class="fa-solid fa-check"></i> Everything in Pro</li>
              <li><i class="fa-solid fa-check"></i> Admin Dashboard</li>
              <li><i class="fa-solid fa-check"></i> Shared Workspace</li>
              <li><i class="fa-solid fa-check"></i> SSO Integration</li>
            </ul>
            <button class="plan-btn free">Contact Sales</button>
          </div>
        </div>
      </div>
    </div>

    <div class="confirm-modal-overlay" id="confirm-delete-modal">
      <div class="confirm-modal">
        <h3>Delete Chat</h3>
        <p id="confirm-delete-text">
          Are you sure you want to delete this chat? This action cannot be
          undone.
        </p>
        <div class="confirm-modal-actions">
          <button
            class="confirm-btn confirm-btn-cancel"
            id="confirm-delete-cancel"
          >
            Cancel
          </button>
          <button
            class="confirm-btn confirm-btn-delete"
            id="confirm-delete-confirm"
          >
            Delete
          </button>
        </div>
      </div>
    </div>
    <!-- Auth Popup Modal -->
<div id="auth-popup" class="auth-popup auth-hidden">
  <div class="auth-popup-content">
    <h2>Thanks for trying LYNQ AI</h2>
    <p>Log in or sign up to get smarter responses, upload files, and more.</p>

    <button class="auth-btn auth-primary" onclick="redirectToLogin()">
      Log in
    </button>

    <button class="auth-btn auth-secondary" onclick="redirectToSignup()">
      Sign up for free
    </button>

    <a href="#" class="auth-skip" onclick="closeAuthPopup(event)">
      Stay logged out
    </a>
  </div>
</div>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>

    <script src="script.js"></script>
    <script src="./home/home.js"></script>
  </body>
</html>